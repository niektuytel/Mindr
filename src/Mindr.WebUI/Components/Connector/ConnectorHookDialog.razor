@using Mindr.Core.Models.Connector;
@inherits FluentComponentBase

<div>
    <FluentDialog Modal="true"
                  TrapFocus="true"
                  @ref="Dialog"
                  @ondialogdismiss="OnDismiss">

        <FluentCombobox Placeholder="Whatsapp message..."
                        Style="width: 100%;"
                        Items=@SearchResults
                        TOption="ConnectorBriefDTO"
                        OptionText="@(i => i.Name)"
                        OptionValue="@(i => i.Id.ToString())"
                        @bind-SelectedOption="@SelectedItem"
                        @bind-Text="@SearchQuery"
                        @oninput="@HandleOnSearch" />

        @if (SelectedItem != null)
        {
            foreach (var variable in SelectedItem.Variables)
            {
                <FluentTextField title="@variable.Description"
                         Placeholder="Required"
                         Style="width: 100%;"
                         @bind-Value="@variable.Value">
                    @variable.Name
                </FluentTextField>
            }
            <Stack HorizontalAlignment="StackHorizontalAlignment.Right" Style="margin-top:5px">
                <FluentButton @onclick="@GoToConnector">
                    <FluentIcon Name="@FluentIcons.Link" Size="@IconSize.Size16" Variant="@IconVariant.Regular" Color="@Color.Accent" />
                </FluentButton>
                <FluentButton Appearance="Appearance.Accent"
                          Autofocus="true"
                          @onclick="HandleOnCreate">
                    Create
                </FluentButton>
            </Stack>
        }
    </FluentDialog>
</div>

