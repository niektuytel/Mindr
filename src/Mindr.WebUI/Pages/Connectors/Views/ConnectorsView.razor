@namespace Mindr.WebUI.Pages.Connectors.Views
@using Mindr.Core.Models.Connectors;
@using Mindr.WebUI.Pages.Connectors.Components
@using Microsoft.AspNetCore.Authorization;
@using System.Collections.ObjectModel;
@using Mindr.WebUI.Models;
@using Newtonsoft.Json;

@inherits FluentComponentBase
@attribute [Authorize]

<Breadcrumb />
<Stack Orientation="Orientation.Horizontal" Class="editable-stack">
    <FluentButton Disabled="false" Appearance="Appearance.Stealth" Style="border-radius: 0;" @onclick="HandleDialogOpen">
        <FluentIcon Slot="start" Name="@FluentIcons.Add" Size="@IconSize.Size16" Variant="@IconVariant.Regular" Color="@Color.Accent" />
        Add
    </FluentButton>
</Stack>
<Stack Orientation="Orientation.Horizontal" HorizontalGap="0" Style="height:100%">
    @if (!string.IsNullOrEmpty(ErrorMessage))
    {
        <Stack Style="min-height:50px;border: 1px solid #D8000C;background-color: #FFBABA;padding: 3px;">
            @ErrorMessage
        </Stack>
    }
    @if (!IsLoadingData)
    {
        <FluentDataGrid TGridItem="ConnectorBriefDTO"
                    RowsDataProvider="@DataProvider"
                    OnCellFocus="HandleCellFocus">
            <PropertyColumn Property="@(p => p.Name)" />
            <PropertyColumn Property="@(p => p.Color)" />
            <PropertyColumn Property="@(p => p.Description)" />
        </FluentDataGrid>
    }
    else
    {
        <Stack HorizontalAlignment="StackHorizontalAlignment.Center" VerticalAlignment="StackVerticalAlignment.Center">
            <FluentProgressRing />
        </Stack>
    }
</Stack>
<ConnectorDialog @ref="Dialog"/>
