@attribute [Route("/calendar/{ViewType?}/{CalendarId?}")]
@*
    ?calendarId=primary
    ?startTime=primary
    ?endTime=primary
*@
@using DemoApp.Models;
@using DemoApp;
@using Microsoft.AspNetCore.Authorization;
@using Mindr.WebAssembly.Client.Pages.Calendar.Components;
@using MudBlazor;

@attribute [Authorize]
@inherits LayoutComponentBase
@inject AppointmentService AppointmentService
@namespace Mindr.WebAssembly.Client.Pages.Calendar

<CalendarMenu @ref="Menu" ViewType="@ViewType" SelectedCalendar="@CalendarId" />
<MudStack Spacing="0" Style="height:100%">
    <Scheduler
        ViewType="@ViewType"
        SelectedCalendar="@CalendarId"
        OnHamburgerClick="@Menu!.ToggleDrawer"
        OnRequestNewData="OnRequestNewData"
        OnAddingNewAppointment="OnAddingNewAppointment"
        OnOverflowAppointmentClick="OnOverflowAppointmentClick"
        EnableRescheduling="true"
    >
        <Appointments>
            @foreach (var element in Appointments)
            {
                <Appointment Start="@element.StartDate.DateTime" End="@element.EndDate.DateTime" Color="@element.Color" OnClick="() => OnAppointmentClicked(element)" OnReschedule="(start, end) => HandleReschedule(element, start, end)">
                    @element.Subject
                </Appointment>
            }
        </Appointments>
    </Scheduler>
</MudStack>
<AppointmentDrawer @ref="AppointmentDrawer" />

