@attribute [Route("/calendar/{CalendarId?}/{CalendarViewType?}")]

@using DemoApp.Models;
@using DemoApp;
@using Microsoft.AspNetCore.Authorization;
@using Mindr.WebAssembly.Client.Pages.Calendar.Components;
@using MudBlazor;

@attribute [Authorize]
@inherits LayoutComponentBase
@inject AppointmentService AppointmentService
@namespace Mindr.WebAssembly.Client.Pages.Calendar




<CalendarMenu @ref="CalendarMenu"/>
<MudStack Spacing="0" Style="height:100%">
    <Scheduler
        OnHamburgerClick="@CalendarMenu!.ToggleDrawer"
        OnRequestNewData="OnRequestNewData"
        OnAddingNewAppointment="OnAddingNewAppointment"
        OnOverflowAppointmentClick="OnOverflowAppointmentClick"
        EnableRescheduling="true"
    >
        <Appointments>
            @foreach (var element in Appointments)
            {
                if (CalendarViewTypeService.IsMonth())
                {
                    <Appointment Data="@element" OnClick="() => OnAppointmentClicked(element)" OnReschedule="(start, end) => HandleReschedule(element, start, end)">
                        @element.Subject
                    </Appointment>
                }
                else
                {
                    <Appointment Data="@element" OnClick="() => OnAppointmentClicked(element)" OnReschedule="(start, end) => HandleReschedule(element, start, end)">
                        @element.Subject
                    </Appointment>
                }
            }
        </Appointments>
    </Scheduler>
</MudStack>
<AppointmentDrawer @ref="AppointmentDrawer" />
